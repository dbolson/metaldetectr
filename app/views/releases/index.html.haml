= render :partial => 'admin/releases/new'
=# render :partial => 'releases/search'
= render :partial => 'releases/pagination', :locals => { :position => 'top' }

= release_filter_select(current_user, params[:filter])

%table.releases
  %tr
    %th{ :class => header_class('band', params[:s]) }= link_to_sort('band', params)
    %th{ :class => header_class('name', params[:s]) }= link_to_sort('name', params)
    %th{ :class => header_class('us_date', params[:s]) }= link_to_sort('us_date', params.merge(:column_name => 'US Release'))
    %th{ :class => header_class('euro_date', params[:s]) }= link_to_sort('euro_date', params.merge(:column_name => 'World Release'))
    %th{ :class => header_class('format', params[:s]) }= link_to_sort('format', params)
    -#%th{ :class => header_class('label', params[:s]) }= link_to_sort('label', params)
    %th.url_header URL
    - if admin?(current_user)
      %th Actions


  - date = @releases.first.us_date
  %tr{ :class => cycle('even', 'odd') }
    %td{ :class => 'month_row', :colspan => 7 }
      - if params[:s].nil?
        = "#{Date::MONTHNAMES[date.month]} #{date.year}"

  - @releases.each do |release|
    - if params[:s].nil?
      - if release.us_date.month > date.month
        - date = release.us_date
        %tr{ :class => cycle('even', 'odd') }
          %td{ :class => 'month_row', :colspan => 7 }
            = "#{Date::MONTHNAMES[date.month]} #{date.year}"

    = render release

= render :partial => 'releases/pagination', :locals => { :position => 'bottom' }
